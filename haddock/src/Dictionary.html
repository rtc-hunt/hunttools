<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Dictionary.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE Safe #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances, UndecidableInstances #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-|
<a name="line-4"></a> Module: Dictionary
<a name="line-5"></a> Description: Select the correct preprocessed form of a dictionary automatically based on the query type
<a name="line-6"></a>
<a name="line-7"></a> We use a simple return type polymorphism mechanism to select the appropriate data structure for the query, so we have things like
<a name="line-8"></a> @ukacd :: (DictionaryContext a) =&gt; a@ where @a@ can be either CrosswordDictionary or AnagramDictionary. The definition for ukacd is then something like
<a name="line-9"></a>
<a name="line-10"></a> &gt; ukacd = fromDictionary $ Dictionary (AnagramDictionary $ fromFile "ukacd-anagram.dawg") (Crossword.BidirectionalDictionary $ fromFile "ukacd-cross.dawg")
<a name="line-11"></a> (not literally that, there are some unsafePerformIO (We know that these files are effectively large constants), "where is this file installed", etc. steps, but that is roughly the correct intuition.)
<a name="line-12"></a>-}</span>
<a name="line-13"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Dictionary</span> <span class='hs-layout'>(</span><span class='hs-conid'>Dictionary</span> <span class='hs-layout'>(</span><span class='hs-conid'>Dictionary</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>anaDict</span><span class='hs-layout'>,</span> <span class='hs-varid'>crossDict</span><span class='hs-layout'>,</span> <span class='hs-conid'>DictionaryContext</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromDictionary</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-14"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Anagram</span>
<a name="line-15"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Crossword</span>
<a name="line-16"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>DAWG</span><span class='hs-varop'>.</span><span class='hs-conid'>Packed64</span>
<a name="line-17"></a>
<a name="line-18"></a><a name="DictionaryContext"></a><span class='hs-comment'>-- | A context that we might want to have a specialized dictionary representation for.</span>
<a name="line-19"></a><a name="DictionaryContext"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>DictionaryContext</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>where</span>
<a name="line-20"></a>  <span class='hs-varid'>fromDictionary</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Dictionary</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<a name="line-21"></a>
<a name="line-22"></a><a name="instance%20(DictionaryContext%20CrosswordDictionary)"></a><span class='hs-comment'>-- | Crossword dictionaries are one form</span>
<a name="line-23"></a><a name="instance%20(DictionaryContext%20CrosswordDictionary)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>DictionaryContext</span> <span class='hs-conid'>CrosswordDictionary</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-24"></a>  <span class='hs-varid'>fromDictionary</span> <span class='hs-varid'>dict</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>crossDict</span> <span class='hs-varid'>dict</span>
<a name="line-25"></a>
<a name="line-26"></a><a name="instance%20(DictionaryContext%20AnagramDictionary)"></a><span class='hs-comment'>-- | Anagram dictionaries are another</span>
<a name="line-27"></a><a name="instance%20(DictionaryContext%20AnagramDictionary)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>DictionaryContext</span> <span class='hs-conid'>AnagramDictionary</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-28"></a>  <span class='hs-varid'>fromDictionary</span> <span class='hs-varid'>dict</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>anaDict</span> <span class='hs-varid'>dict</span>
<a name="line-29"></a>
<a name="line-30"></a><a name="instance%20(DictionaryContext%20Dictionary)"></a><span class='hs-comment'>-- | A context for the raw Dictionary structure; this lets us still use the ukacd term when we /don't/ want to do dispatch, and instead access all of the dictionaries available.</span>
<a name="line-31"></a><a name="instance%20(DictionaryContext%20Dictionary)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>DictionaryContext</span> <span class='hs-conid'>Dictionary</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-32"></a>  <span class='hs-varid'>fromDictionary</span> <span class='hs-varid'>dict</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dict</span>
<a name="line-33"></a>
<a name="line-34"></a><a name="Dictionary"></a><span class='hs-comment'>-- | Effectively, a Dictionary object consists of a copy of the dictionary structured for anagrams and the same dictionary structured for crossword queries. If we find that there are more data structures that are useful and we want all the dictionaries in, we can add them here (and add an appropriate 'DictionaryContext' instance).</span>
<a name="line-35"></a><a name="Dictionary"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Dictionary</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Dictionary</span> <span class='hs-layout'>{</span><span class='hs-varid'>anaDict</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>AnagramDictionary</span><span class='hs-layout'>,</span> <span class='hs-varid'>crossDict</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CrosswordDictionary</span><span class='hs-layout'>}</span>
<a name="line-36"></a>
<a name="line-37"></a><span class='hs-comment'>--instance (DictionaryContext a) =&gt; (Show a) where</span>
<a name="line-38"></a><span class='hs-comment'>--	show = (\a -&gt; "&lt;Dictionary&gt;")::(DictionaryContext a)=&gt;a-&gt;String</span>
<a name="line-39"></a>
<a name="line-40"></a><span class='hs-comment'>--instance Show Dictionary where</span>
<a name="line-41"></a><span class='hs-comment'>--	show d = "&lt;Dictionary&gt;"</span>
</pre></body>
</html>
